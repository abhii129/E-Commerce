import{B as c}from"./chunk-BaseElement-CopzcQ-j.js";import{t as o}from"./chunk-tracking-DO2MhGcG.js";import{t as h}from"./chunk-custom-element-BhZVzxrc.js";import"./chunk-lit-element-B04JoW0t.js";var d=Object.getOwnPropertyDescriptor,v=(t,e,i,r)=>{for(var a=r>1?void 0:r?d(e,i):e,s=t.length-1,n;s>=0;s--)(n=t[s])&&(a=n(a)||a);return a};let l=class extends c{constructor(){super(),this.observer=null,this.timeoutId=null,this.activeIntervals=new Set,this.trackingObserver=null,this.trackingObserverTimeoutId=null,this.trackingIntervalId=null,this.trackingIntervalTimeoutId=null,this.tracked=!1,this.cleanup=this.cleanup.bind(this),this.applyStyles=this.applyStyles.bind(this),this.handleTracking=this.handleTracking.bind(this)}connectedCallback(){super.connectedCallback(),this.initializeObserver(),this.initializeTrackingObserver()}disconnectedCallback(){super.disconnectedCallback(),this.cleanup()}cleanup(){this.observer&&(this.observer.disconnect(),this.observer=null),this.trackingObserver&&(this.trackingObserver.disconnect(),this.trackingObserver=null),this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),this.trackingObserverTimeoutId&&(clearTimeout(this.trackingObserverTimeoutId),this.trackingObserverTimeoutId=null),this.trackingIntervalId&&(clearInterval(this.trackingIntervalId),this.trackingIntervalId=null),this.trackingIntervalTimeoutId&&(clearTimeout(this.trackingIntervalTimeoutId),this.trackingIntervalTimeoutId=null),this.activeIntervals.forEach(t=>clearInterval(t)),this.activeIntervals.clear()}handleTracking(){this.tracked||this.trackingIntervalId||this.querySelector("shopify-payment-terms")&&(this.trackingObserver&&(this.trackingObserver.disconnect(),this.trackingObserver=null),this.trackingObserverTimeoutId&&(clearTimeout(this.trackingObserverTimeoutId),this.trackingObserverTimeoutId=null),this.trackingIntervalId=window.setInterval(()=>{window.amplitude&&(this.tracked||(o({name:"ShopPay Installments Viewed"}),this.tracked=!0),this.trackingIntervalId&&(clearInterval(this.trackingIntervalId),this.trackingIntervalId=null),this.trackingIntervalTimeoutId&&(clearTimeout(this.trackingIntervalTimeoutId),this.trackingIntervalTimeoutId=null))},300),this.trackingIntervalTimeoutId=window.setTimeout(()=>{this.trackingIntervalId&&(clearInterval(this.trackingIntervalId),this.trackingIntervalId=null)},1e4))}initializeTrackingObserver(){this.handleTracking(),!(this.tracked||this.trackingIntervalId)&&(this.trackingObserver=new MutationObserver(this.handleTracking),this.trackingObserver.observe(this,{childList:!0,subtree:!0}),this.trackingObserverTimeoutId=window.setTimeout(()=>{this.trackingObserver&&(this.trackingObserver.disconnect(),this.trackingObserver=null)},1e4))}applyStyles(t){const e=window.setInterval(()=>{if(t.shadowRoot){clearInterval(e),this.activeIntervals.delete(e);const i=document.createElement("style");i.textContent=`
          section[aria-modal="true"] {
            max-height: calc(100vh - 40px);
            overflow-y: auto;
          }
          @media (max-width: 448px) {
            section[aria-modal="true"] {
            top: 20px;
            }
          }
        `,t.shadowRoot.appendChild(i)}},100);this.activeIntervals.add(e),setTimeout(()=>{clearInterval(e),this.activeIntervals.delete(e)},2e3)}initializeObserver(){const t='[data-nametag="shop-portal-provider"][data-type="modal"]';document.querySelectorAll(t).forEach(this.applyStyles),this.observer=new MutationObserver(e=>{for(const i of e)i.type==="childList"&&i.addedNodes.forEach(r=>{r.nodeType===Node.ELEMENT_NODE&&r.matches(t)&&this.applyStyles(r)})}),this.observer.observe(document.body,{childList:!0}),this.timeoutId=window.setTimeout(()=>{this.observer&&this.observer.disconnect()},5e3)}};l=v([h("installment-payment-wrapper")],l);
